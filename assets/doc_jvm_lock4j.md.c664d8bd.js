import{_ as s,c as e,o as a,a as n}from"./app.bd26c8cd.js";const k=JSON.parse('{"title":"Lock4j(generated by newbing)","description":"","frontmatter":{},"headers":[],"relativePath":"doc/jvm/lock4j.md","lastUpdated":1682598962000}'),o={name:"doc/jvm/lock4j.md"},l=n(`<h1 id="lock4j-generated-by-newbing" tabindex="-1">Lock4j(generated by newbing) <a class="header-anchor" href="#lock4j-generated-by-newbing" aria-hidden="true">#</a></h1><h2 id="详细介绍下lock4j" tabindex="-1">详细介绍下lock4j <a class="header-anchor" href="#详细介绍下lock4j" aria-hidden="true">#</a></h2><p>Lock4j是一个分布式锁组件，它提供了多种不同的支持以满足不同性能和环境的需求，基于Spring AOP的声明式和编程式分布式锁，支持RedisTemplate、Redisson、Zookeeper。Lock4j提供了多种不同的支持以满足不同性能和环境的需求，支持redission、redisTemplate、zookeeper，可混用，支持扩展。Lock4j是一个简单但富有内涵的分布式锁组件。¹²</p><p>源: 与必应的对话， 4/27/2023 (1) 推荐一个分布式锁框架Lock4j - 掘金. <a href="https://juejin.cn/post/7210653822850547770" target="_blank" rel="noreferrer">https://juejin.cn/post/7210653822850547770</a>. (2) lock4j: 基于Spring AOP 的声明式和编程式分布式锁 ... - Gitee. <a href="https://gitee.com/baomidou/lock4j" target="_blank" rel="noreferrer">https://gitee.com/baomidou/lock4j</a>. (3) lock4j--分布式锁中间件--使用/实例_IT利刃出鞘的博客-CSDN博客. <a href="https://blog.csdn.net/feiying0canglang/article/details/125321100" target="_blank" rel="noreferrer">https://blog.csdn.net/feiying0canglang/article/details/125321100</a>. (4) The Log4J Vulnerability Will Haunt the Internet for Years | WIRED. <a href="https://www.wired.com/story/log4j-log4shell/" target="_blank" rel="noreferrer">https://www.wired.com/story/log4j-log4shell/</a>.</p><h2 id="lock4j有哪些特性" tabindex="-1">Lock4j有哪些特性？ <a class="header-anchor" href="#lock4j有哪些特性" aria-hidden="true">#</a></h2><p>根据搜索结果，Lock4j有以下几个特性：</p><ul><li><strong>简单易用，功能强大，扩展性强</strong>。Lock4j提供了基于Spring AOP的声明式和编程式分布式锁，支持自定义执行器、锁key生成器、锁获取失败策略等。¹</li><li><strong>支持redission,redisTemplate,zookeeper</strong>。Lock4j可以根据底层需要配置redis或zookeeper，也可以混用不同的锁实现。¹²</li><li><strong>支持全局默认的获取锁超时时间和锁过期时间</strong>。Lock4j可以配置acquire-timeout和expire参数，以防止获取锁超时和死锁的情况。¹</li></ul><p>源: 与必应的对话， 4/27/2023 (1) lock4j: 基于Spring AOP 的声明式和编程式分布式锁 ... - Gitee. <a href="https://gitee.com/baomidou/lock4j" target="_blank" rel="noreferrer">https://gitee.com/baomidou/lock4j</a>. (2) 推荐一个分布式锁框架Lock4j - 掘金. <a href="https://juejin.cn/post/7210653822850547770" target="_blank" rel="noreferrer">https://juejin.cn/post/7210653822850547770</a>. (3) lock4j--分布式锁中间件--使用/实例_IT利刃出鞘的博客-CSDN博客. <a href="https://blog.csdn.net/feiying0canglang/article/details/125321100" target="_blank" rel="noreferrer">https://blog.csdn.net/feiying0canglang/article/details/125321100</a>. (4) What is Log4j? | NortonLifeLock Blogs. <a href="https://www.nortonlifelock.com/blogs/norton-labs/what-log4j" target="_blank" rel="noreferrer">https://www.nortonlifelock.com/blogs/norton-labs/what-log4j</a>.</p><h2 id="lock4j如何使用" tabindex="-1">Lock4j如何使用？ <a class="header-anchor" href="#lock4j如何使用" aria-hidden="true">#</a></h2><p>根据搜索结果，Lock4j的使用方法如下：</p><ul><li><strong>引入相关依赖</strong>。Lock4j支持同时存在不同的锁实现，需要根据底层选择引入相应的依赖，例如lock4j-redisson-spring-boot-starter、lock4j-redis-template-spring-boot-starter、lock4j-zookeeper-spring-boot-starter等。¹</li><li><strong>配置底层参数</strong>。Lock4j需要根据底层需要配置redis或zookeeper的相关参数，例如host、port、password等。¹</li><li><strong>使用Lock4j注解</strong>。Lock4j提供了基于Spring AOP的声明式和编程式分布式锁，可以在需要分布式的地方使用@Lock4j注解，可以指定keys、expire、acquireTimeout等参数，也可以使用SPEL表达式。¹²</li></ul><p>源: 与必应的对话， 4/27/2023 (1) lock4j: 基于Spring AOP 的声明式和编程式分布式锁 ... - Gitee. <a href="https://gitee.com/baomidou/lock4j" target="_blank" rel="noreferrer">https://gitee.com/baomidou/lock4j</a>. (2) lock4j--分布式锁中间件--使用/实例_IT利刃出鞘的博客-CSDN博客. <a href="https://blog.csdn.net/feiying0canglang/article/details/125321100" target="_blank" rel="noreferrer">https://blog.csdn.net/feiying0canglang/article/details/125321100</a>. (3) lock4j--分布式锁中间件--使用实例 - CSDN博客. <a href="https://blog.csdn.net/m0_67402013/article/details/126061596" target="_blank" rel="noreferrer">https://blog.csdn.net/m0_67402013/article/details/126061596</a>. (4) SpringBoot整合Lock4j_@lock4j_丿SeeYouAgain的博客-CSDN博客. <a href="https://blog.csdn.net/ldllovegyh/article/details/125793993" target="_blank" rel="noreferrer">https://blog.csdn.net/ldllovegyh/article/details/125793993</a>.</p><h2 id="lock4j支持哪些底层" tabindex="-1">Lock4j支持哪些底层？ <a class="header-anchor" href="#lock4j支持哪些底层" aria-hidden="true">#</a></h2><p>Lock4j支持RedisTemplate、Redisson、Zookeeper作为底层，可以根据不同的性能和环境的需求选择不同的支持。Lock4j也可以混用不同的锁实现，也支持扩展自定义的执行器。</p><h2 id="lock4j有什么高级使用方法" tabindex="-1">Lock4j有什么高级使用方法？ <a class="header-anchor" href="#lock4j有什么高级使用方法" aria-hidden="true">#</a></h2><p>根据搜索结果，Lock4j的高级使用方法有以下几种：</p><ul><li><strong>配置全局默认的获取锁超时时间和锁过期时间</strong>。Lock4j可以配置acquire-timeout和expire参数，以防止获取锁超时和死锁的情况。¹</li><li><strong>自定义执行器</strong>。Lock4j可以在方法级指定使用某种执行器，也可以扩展自定义的执行器，例如RedissonLockExecutor、RedisTemplateLockExecutor、ZookeeperLockExecutor等。¹²</li><li><strong>自定义锁key生成器</strong>。Lock4j可以扩展自定义的锁key生成器，继承DefaultLockKeyBuilder类，重写buildKey方法，实现自己的逻辑。¹²</li><li><strong>自定义锁获取失败策略</strong>。Lock4j可以扩展自定义的锁获取失败策略，实现LockFailureStrategy接口，重写onLockFailure方法，实现自己的逻辑。¹²</li><li><strong>手动上锁解锁</strong>。Lock4j可以通过编程式的方式手动上锁解锁，需要注入LockTemplate类，调用lock方法传入key和回调函数，或者调用tryLock方法传入key、过期时间、超时时间和回调函数。¹²</li></ul><p>源: 与必应的对话， 4/27/2023 (1) 推荐一个分布式锁框架Lock4j - 掘金. <a href="https://juejin.cn/post/7210653822850547770" target="_blank" rel="noreferrer">https://juejin.cn/post/7210653822850547770</a>. (2) lock4j--分布式锁中间件--使用/实例_IT利刃出鞘的博客-CSDN博客. <a href="https://blog.csdn.net/feiying0canglang/article/details/125321100" target="_blank" rel="noreferrer">https://blog.csdn.net/feiying0canglang/article/details/125321100</a>. (3) lock4j: 基于Spring AOP 的声明式和编程式分布式锁 ... - Gitee. <a href="https://gitee.com/baomidou/lock4j" target="_blank" rel="noreferrer">https://gitee.com/baomidou/lock4j</a>.</p><h2 id="lock4j和redisson有什么区别" tabindex="-1">Lock4j和Redisson有什么区别？ <a class="header-anchor" href="#lock4j和redisson有什么区别" aria-hidden="true">#</a></h2><p>根据搜索结果，Lock4j和Redisson的区别有以下几点：</p><ul><li><strong>Lock4j是一个分布式锁组件，Redisson是一个基于Redis的Java驻内存数据网格</strong>。Lock4j提供了基于Spring AOP的声明式和编程式分布式锁，支持RedisTemplate、Redisson、Zookeeper作为底层。Redisson实现了分布式和可扩展的Java数据结构，不仅支持字符串操作，还支持排序、事务、管道、分区等Redis特性。¹²</li><li><strong>Lock4j可以选择不同的底层实现，Redisson只能基于Redis</strong>。Lock4j可以根据不同的性能和环境的需求选择不同的支持，也可以混用不同的锁实现，也支持扩展自定义的执行器。Redisson只能使用Redis作为底层，不能使用其他的存储方式。¹²</li><li><strong>Lock4j只提供了分布式锁的功能，Redisson提供了更多的分布式服务</strong>。Lock4j只提供了基于Spring AOP的声明式和编程式分布式锁，没有提供其他的分布式服务。Redisson不仅提供了一系列的分布式Java常用对象，还提供了许多分布式服务，其中包括（ BitSet, Set, Multimap, SortedSet, Map, List, Queue, BlockingQueue, Deque, BlockingDeque, Semaphore, Lock, AtomicLong, CountDownLatch, Publish / Subscribe, Bloom filter, Remote service, Spring cache, Executor service, Live Object service, Scheduler service ）。²³</li></ul><p>源: 与必应的对话， 4/27/2023 (1) Jedis vs Redisson，到底怎么选？ - 腾讯云开发者社区-腾讯云. <a href="https://cloud.tencent.com/developer/article/1594456" target="_blank" rel="noreferrer">https://cloud.tencent.com/developer/article/1594456</a>. (2) Redis 客户端 Jedis、lettuce 和 Redisson 对比 - 程序员自由之路 - 博客园. <a href="https://www.cnblogs.com/54chensongxia/p/13815761.html" target="_blank" rel="noreferrer">https://www.cnblogs.com/54chensongxia/p/13815761.html</a>. (3) lock4j: 基于Spring AOP 的声明式和编程式分布式锁 ... - Gitee. <a href="https://gitee.com/baomidou/lock4j" target="_blank" rel="noreferrer">https://gitee.com/baomidou/lock4j</a>. (4) 细说Redis分布式锁：setnx/redisson/redlock？了解一波？ - 知乎. <a href="https://zhuanlan.zhihu.com/p/111354065" target="_blank" rel="noreferrer">https://zhuanlan.zhihu.com/p/111354065</a>.</p><h2 id="你能给我一个手动上锁解锁的示例代码吗" tabindex="-1">你能给我一个手动上锁解锁的示例代码吗？ <a class="header-anchor" href="#你能给我一个手动上锁解锁的示例代码吗" aria-hidden="true">#</a></h2><p>根据搜索结果，Lock4j的示例代码如下：</p><ul><li><strong>使用Lock4j注解</strong>。Lock4j提供了基于Spring AOP的声明式和编程式分布式锁，可以在需要分布式的地方使用@Lock4j注解，可以指定keys、expire、acquireTimeout等参数，也可以使用SPEL表达式。¹²</li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Service</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DemoService</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//默认获取锁超时3秒，30秒锁过期</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Lock4j</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">simple</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//do something</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//完全配置，支持spel</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Lock4j</span><span style="color:#89DDFF;">(</span><span style="color:#FFCB6B;">keys</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#user.id</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">#user.name</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">},</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">expire</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">60000</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">acquireTimeout</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#89DDFF;">)</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">customMethod</span><span style="color:#89DDFF;">(</span><span style="color:#C792EA;">User</span><span style="color:#A6ACCD;"> </span><span style="color:#A6ACCD;font-style:italic;">user</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> user</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><ul><li><strong>手动上锁解锁</strong>。Lock4j可以通过编程式的方式手动上锁解锁，需要注入LockTemplate类，调用lock方法传入key和回调函数，或者调用tryLock方法传入key、过期时间、超时时间和回调函数。²</li></ul><div class="language-java"><button title="Copy Code" class="copy"></button><span class="lang">java</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Service</span></span>
<span class="line"><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">class</span><span style="color:#A6ACCD;"> </span><span style="color:#FFCB6B;">DemoService</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">@</span><span style="color:#C792EA;">Autowired</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">private</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">LockTemplate</span><span style="color:#A6ACCD;"> lockTemplate</span><span style="color:#89DDFF;">;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#C792EA;">public</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">void</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">manual</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//手动上锁解锁</span></span>
<span class="line"><span style="color:#A6ACCD;">        lockTemplate</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">lock</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lockKey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//do something</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">});</span></span>
<span class="line"></span>
<span class="line"><span style="color:#89DDFF;">        </span><span style="color:#676E95;font-style:italic;">//带超时时间的手动上锁解锁</span></span>
<span class="line"><span style="color:#A6ACCD;">        lockTemplate</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">tryLock</span><span style="color:#89DDFF;">(</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">lockKey</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">30000</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">1000</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">-&gt;</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">            </span><span style="color:#676E95;font-style:italic;">//do something</span></span>
<span class="line"><span style="color:#A6ACCD;">            </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">null;</span></span>
<span class="line"><span style="color:#A6ACCD;">        </span><span style="color:#89DDFF;">});</span></span>
<span class="line"><span style="color:#A6ACCD;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span></code></pre></div><p>源: 与必应的对话， 4/27/2023 (1) lock4j--分布式锁中间件--使用/实例_IT利刃出鞘的博客-CSDN博客. <a href="https://blog.csdn.net/feiying0canglang/article/details/125321100" target="_blank" rel="noreferrer">https://blog.csdn.net/feiying0canglang/article/details/125321100</a>. (2) lock4j: 基于Spring AOP 的声明式和编程式分布式锁 ... - Gitee. <a href="https://gitee.com/baomidou/lock4j" target="_blank" rel="noreferrer">https://gitee.com/baomidou/lock4j</a>. (3) 推荐一个分布式锁框架Lock4j - 掘金. <a href="https://juejin.cn/post/7210653822850547770" target="_blank" rel="noreferrer">https://juejin.cn/post/7210653822850547770</a>. (4) Maven Repository: com.baomidou » lock4j-core. <a href="https://mvnrepository.com/artifact/com.baomidou/lock4j-core" target="_blank" rel="noreferrer">https://mvnrepository.com/artifact/com.baomidou/lock4j-core</a>.</p>`,29),t=[l];function p(r,c,i,y,D,d){return a(),e("div",null,t)}const C=s(o,[["render",p]]);export{k as __pageData,C as default};
