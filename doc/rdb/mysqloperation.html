<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>MYSQL 运维相关 | Lumiseven's blog</title>
    <meta name="description" content="lumiseven's personal blog.">
    <link rel="preload stylesheet" href="/assets/style.2df32089.css" as="style">
    <link rel="modulepreload" href="/assets/app.8443043e.js">
    <link rel="modulepreload" href="/assets/doc_rdb_mysqloperation.md.4dff3f24.lean.js">
    
    <meta name="theme-color" content="#3c8772">
  <script id="check-dark-light">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-93a960b4><!--[--><!--]--><!--[--><span tabindex="-1" data-v-151f2593></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-151f2593> Skip to content </a><!--]--><!----><header class="VPNav" data-v-93a960b4 data-v-0fa0e57d><div class="VPNavBar has-sidebar" data-v-0fa0e57d data-v-be450ad9><div class="container" data-v-be450ad9><div class="title" data-v-be450ad9><div class="VPNavBarTitle has-sidebar" data-v-be450ad9 data-v-6d2fb2d9><a class="title" href="/" data-v-6d2fb2d9><!--[--><!--]--><!----><!--[-->Lumiseven&#39;s blog<!--]--><!--[--><!--]--></a></div></div><div class="content" data-v-be450ad9><div class="curtain" data-v-be450ad9></div><div class="content-body" data-v-be450ad9><!--[--><!--]--><!----><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-be450ad9 data-v-bdedfc22><span id="main-nav-aria-label" class="visually-hidden" data-v-bdedfc22>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink active" href="/doc/index" data-v-bdedfc22 data-v-f2ec7ecf data-v-a8b5c975><!--[-->Document<!--]--><!----></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/jotting/index" data-v-bdedfc22 data-v-f2ec7ecf data-v-a8b5c975><!--[-->Jotting<!--]--><!----></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-be450ad9 data-v-da3f667a><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-da3f667a data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-be450ad9 data-v-2ab2a029 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/lumiseven/" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-be450ad9 data-v-66bb1f24 data-v-96001b6b><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-96001b6b><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="icon" data-v-96001b6b><circle cx="12" cy="12" r="2"></circle><circle cx="19" cy="12" r="2"></circle><circle cx="5" cy="12" r="2"></circle></svg></button><div class="menu" data-v-96001b6b><div class="VPMenu" data-v-96001b6b data-v-e7ea1737><!----><!--[--><!--[--><!----><div class="group" data-v-66bb1f24><div class="item appearance" data-v-66bb1f24><p class="label" data-v-66bb1f24>Appearance</p><div class="appearance-action" data-v-66bb1f24><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" aria-label="toggle dark mode" aria-checked="false" data-v-66bb1f24 data-v-0d529b6d data-v-f3c41672><span class="check" data-v-f3c41672><span class="icon" data-v-f3c41672><!--[--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="sun" data-v-0d529b6d><path d="M12,18c-3.3,0-6-2.7-6-6s2.7-6,6-6s6,2.7,6,6S15.3,18,12,18zM12,8c-2.2,0-4,1.8-4,4c0,2.2,1.8,4,4,4c2.2,0,4-1.8,4-4C16,9.8,14.2,8,12,8z"></path><path d="M12,4c-0.6,0-1-0.4-1-1V1c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,3.6,12.6,4,12,4z"></path><path d="M12,24c-0.6,0-1-0.4-1-1v-2c0-0.6,0.4-1,1-1s1,0.4,1,1v2C13,23.6,12.6,24,12,24z"></path><path d="M5.6,6.6c-0.3,0-0.5-0.1-0.7-0.3L3.5,4.9c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C6.2,6.5,5.9,6.6,5.6,6.6z"></path><path d="M19.8,20.8c-0.3,0-0.5-0.1-0.7-0.3l-1.4-1.4c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l1.4,1.4c0.4,0.4,0.4,1,0,1.4C20.3,20.7,20,20.8,19.8,20.8z"></path><path d="M3,13H1c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S3.6,13,3,13z"></path><path d="M23,13h-2c-0.6,0-1-0.4-1-1s0.4-1,1-1h2c0.6,0,1,0.4,1,1S23.6,13,23,13z"></path><path d="M4.2,20.8c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C4.7,20.7,4.5,20.8,4.2,20.8z"></path><path d="M18.4,6.6c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l1.4-1.4c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-1.4,1.4C18.9,6.5,18.6,6.6,18.4,6.6z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="moon" data-v-0d529b6d><path d="M12.1,22c-0.3,0-0.6,0-0.9,0c-5.5-0.5-9.5-5.4-9-10.9c0.4-4.8,4.2-8.6,9-9c0.4,0,0.8,0.2,1,0.5c0.2,0.3,0.2,0.8-0.1,1.1c-2,2.7-1.4,6.4,1.3,8.4c2.1,1.6,5,1.6,7.1,0c0.3-0.2,0.7-0.3,1.1-0.1c0.3,0.2,0.5,0.6,0.5,1c-0.2,2.7-1.5,5.1-3.6,6.8C16.6,21.2,14.4,22,12.1,22zM9.3,4.4c-2.9,1-5,3.6-5.2,6.8c-0.4,4.4,2.8,8.3,7.2,8.7c2.1,0.2,4.2-0.4,5.8-1.8c1.1-0.9,1.9-2.1,2.4-3.4c-2.5,0.9-5.3,0.5-7.5-1.1C9.2,11.4,8.1,7.7,9.3,4.4z"></path></svg><!--]--></span></span></button></div></div></div><div class="group" data-v-66bb1f24><div class="item social-links" data-v-66bb1f24><div class="VPSocialLinks social-links-list" data-v-66bb1f24 data-v-f6988cfb><!--[--><a class="VPSocialLink" href="https://github.com/lumiseven/" target="_blank" rel="noopener" data-v-f6988cfb data-v-e57698f6><svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-be450ad9 data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav" data-v-93a960b4 data-v-2817d72e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2817d72e><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="menu-icon" data-v-2817d72e><path d="M17,11H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,11,17,11z"></path><path d="M21,7H3C2.4,7,2,6.6,2,6s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,7,21,7z"></path><path d="M21,15H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h18c0.6,0,1,0.4,1,1S21.6,15,21,15z"></path><path d="M17,19H3c-0.6,0-1-0.4-1-1s0.4-1,1-1h14c0.6,0,1,0.4,1,1S17.6,19,17,19z"></path></svg><span class="menu-text" data-v-2817d72e>Menu</span></button><a class="top-link" href="#" data-v-2817d72e>Return to top</a></div><aside class="VPSidebar" data-v-93a960b4 data-v-c79ccefa><div class="curtain" data-v-c79ccefa></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-c79ccefa><span class="visually-hidden" id="sidebar-aria-label" data-v-c79ccefa> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>AIGC</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/ai/random_forest_model" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>随机森林模型</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/ai/project" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Stable diffusion</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>JVM</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/jvm/javabase" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Java 基础</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/jvm_readme/blob/master/Java%E6%96%B0%E7%89%B9%E6%80%A7%E4%BB%8B%E7%BB%8D.md" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Java 新特性介绍(8~17)</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/jvm_readme#jvm-%E5%86%85%E5%AD%98%E5%B8%83%E5%B1%80%E8%AF%A6%E8%A7%A3" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>JVM 内存布局详解</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/jvm/concurrency" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Java 并发编程</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/jvm_readme/tree/master/io#bionioaionetty" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>BIO、NIO、AIO、Netty</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/jvm/kotlin_corouties" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>kotlin coroutines</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/jvm/lock4j" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>lock4j</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/jvm/hippo4j" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>hippo4j</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible has-active" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>Database</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/rdb/mysqlquestion" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Mysql 常见问题</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link is-active has-active" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/rdb/mysqloperation" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Mysql O&M</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/rdb/querybigdata" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Mysql 查询大量数据(流式查询)</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/rdb/mysqlfulltextsearch" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Mysql 全文索引</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/rdb/mysqlspatialindex" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Mysql 地理空间索引</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/rdb/mysqlvspostgres" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Mysql vs Postgres</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>Redis</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/redis_readme#%E7%BB%86%E8%AF%B4-redis-70-%E7%9A%84%E4%B9%9D%E7%A7%8D%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E5%8F%8A%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>细说 Redis 7.0 的九种数据类型及应用场景</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/redis_readme/blob/master/mysql-redis-cache-flush.md#mysqlredis%E5%A6%82%E4%BD%95%E4%BF%9D%E8%AF%81%E5%8F%8C%E5%86%99%E4%B8%80%E8%87%B4%E6%80%A7" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>mysql,redis如何保证双写一致性</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/redis_readme/blob/master/cache-strategy.md#redis%E7%9A%84%E5%88%A0%E9%99%A4%E7%AD%96%E7%95%A5%E4%B8%8E%E6%B7%98%E6%B1%B0%E7%AD%96%E7%95%A5%E6%9C%89%E4%BB%80%E4%B9%88%E5%8C%BA%E5%88%AB" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>redis的删除策略与淘汰策略有什么区别</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/seven-org/redis_readme/blob/master/Redis-Lua.md#redis-%E4%B8%AD-lua-%E8%84%9A%E6%9C%AC%E7%9A%84%E5%BA%94%E7%94%A8%E5%92%8C%E5%AE%9E%E8%B7%B5" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Redis 中 Lua 脚本的应用和实践</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>Git</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/git/command" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Git 常用命令</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>Nginx</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/nginx/nginx" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Nginx</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/nginx/nginxvscaddy" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Nginx vs Caddy</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/nginx/caddy" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Caddy</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/nginx/haproxyandnginx" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>Haproxy + Nginx</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>Elasticsearch</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/es/index" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>ES</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/lumiseven/es-memo/blob/master/write_operation.md#es-%E7%9A%84%E5%86%99%E5%85%A5%E8%BF%87%E7%A8%8B" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>ES 的写入过程</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://github.com/lumiseven/es-memo/blob/master/http_operate.md#http-%E6%93%8D%E4%BD%9C" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>ES RESTAPI 操作 Demo</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/es/geo" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>ES geo</p><!--]--><!----></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/es/infrequentoperation" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>ES 不常用操作记录</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><div class="group" data-v-c79ccefa><section class="VPSidebarItem level-0 collapsible" data-v-c79ccefa data-v-983f6b21><div class="item" role="button" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link" data-v-983f6b21 data-v-a8b5c975><!--[--><h2 class="text" data-v-983f6b21>Others</h2><!--]--><!----></a><div class="caret" role="button" data-v-983f6b21><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="caret-icon" data-v-983f6b21><path d="M9,19c-0.3,0-0.5-0.1-0.7-0.3c-0.4-0.4-0.4-1,0-1.4l5.3-5.3L8.3,6.7c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l6,6c0.4,0.4,0.4,1,0,1.4l-6,6C9.5,18.9,9.3,19,9,19z"></path></svg></div></div><div class="items" data-v-983f6b21><!--[--><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="https://gist.github.com/lumiseven/af46c3fb0f7d1865007912f8866d60ea" target="_blank" rel="noreferrer" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>正则表达式</p><!--]--><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" height="24px" viewbox="0 0 24 24" width="24px" class="icon" data-v-a8b5c975><path d="M0 0h24v24H0V0z" fill="none"></path><path d="M9 5v2h6.59L4 18.59 5.41 20 17 8.41V15h2V5H9z"></path></svg></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-983f6b21 data-v-983f6b21><div class="item" data-v-983f6b21><div class="indicator" data-v-983f6b21></div><a class="VPLink link link" href="/doc/others/http1_1_vs_http2" data-v-983f6b21 data-v-a8b5c975><!--[--><p class="text" data-v-983f6b21>http1.1 vs http2</p><!--]--><!----></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-93a960b4 data-v-0bd490fb><div class="VPDoc has-sidebar has-aside" data-v-0bd490fb data-v-c5936a1e><div class="container" data-v-c5936a1e><div class="aside" data-v-c5936a1e><div class="aside-curtain" data-v-c5936a1e></div><div class="aside-container" data-v-c5936a1e><div class="aside-content" data-v-c5936a1e><div class="VPDocAside" data-v-c5936a1e data-v-cdc66372><!--[--><!--]--><!--[--><!--]--><div class="VPDocAsideOutline" data-v-cdc66372 data-v-5dd9d5f6><div class="content" data-v-5dd9d5f6><div class="outline-marker" data-v-5dd9d5f6></div><div class="outline-title" data-v-5dd9d5f6>On this page</div><nav aria-labelledby="doc-outline-aria-label" data-v-5dd9d5f6><span class="visually-hidden" id="doc-outline-aria-label" data-v-5dd9d5f6> Table of Contents for current page </span><ul class="root" data-v-5dd9d5f6 data-v-1188541a><!--[--><!--]--></ul></nav></div></div><!--[--><!--]--><div class="spacer" data-v-cdc66372></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-c5936a1e><div class="content-container" data-v-c5936a1e><!--[--><!--]--><main class="main" data-v-c5936a1e><div style="position:relative;" class="vp-doc _doc_rdb_mysqloperation" data-v-c5936a1e><div><h1 id="mysql-运维相关" tabindex="-1">MYSQL 运维相关 <a class="header-anchor" href="#mysql-运维相关" aria-hidden="true">#</a></h1><h2 id="my-cnf-常见配置" tabindex="-1"><a href="https://gist.github.com/lumiseven/a3aa2489729159e1b992cec379fdb4ed" target="_blank" rel="noreferrer">my.cnf 常见配置</a> <a class="header-anchor" href="#my-cnf-常见配置" aria-hidden="true">#</a></h2><h2 id="集群架构类型" tabindex="-1">集群架构类型 <a class="header-anchor" href="#集群架构类型" aria-hidden="true">#</a></h2><p>MySQL集群架构的类型有很多，根据不同的需求和场景，可以选择合适的方案。一般来说，MySQL集群架构可以分为以下几类：</p><ul><li>主从模式：这是最基本的集群架构，只有一个主库负责写操作，一个或多个从库负责读操作。这种模式可以实现读写分离和数据备份，但是主库是单点故障，如果主库宕机，需要手动切换到从库。</li><li>双主模式：两个主库互为主从，可以实现双向复制和高可用。这种模式可以提高写性能和容灾能力，但是可能会出现数据冲突或延迟的问题。</li><li>MHA模式：这是一种基于主从模式的高可用方案，使用MHA（Master High Availability）工具来监控和管理集群。MHA可以自动检测主库故障，并在最短时间内切换到最新的从库。这种模式可以避免人工干预和数据丢失的风险，但是需要额外安装和配置MHA工具。</li><li>PXC模式：这是一种基于Galera Cluster技术的多主模式，所有节点都可以进行读写操作，并通过认证多播协议（GCS）来保证数据一致性。PXC（Percona XtraDB Cluster）是Percona公司提供的一个开源产品，可以实现真正的同步复制和无中心化架构。这种模式可以提供高性能和高扩展性，但是可能会增加网络开销和复杂度。</li></ul><h2 id="主从集群配置" tabindex="-1">主从集群配置 <a class="header-anchor" href="#主从集群配置" aria-hidden="true">#</a></h2><p>MySQL主从复制集群是一种常见的数据库架构，可以实现数据的高可用性、负载均衡和故障恢复。</p><ul><li><p>配置一个主从复制集群的大致步骤如下：</p><ol><li>在主服务器上开启二进制日志，并设置唯一的服务器ID。</li><li>在从服务器上开启二进制日志，并设置唯一的服务器ID。</li><li>在主服务器上创建一个专用的复制用户，并授予相应的权限。</li><li>在从服务器上配置主服务器的地址、端口、用户名和密码，并启动复制进程。</li><li>在主从服务器上分别检查复制状态，确保没有错误或延迟。</li></ol></li><li><p>示例:</p><ol><li>在主服务器上，编辑my.cnf文件，添加以下内容：<div class="language-conf"><button title="Copy Code" class="copy"></button><span class="lang">conf</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">[mysqld]</span></span>
<span class="line"><span style="color:#A6ACCD;">server-id=1</span></span>
<span class="line"><span style="color:#A6ACCD;">log-bin=mysql-bin</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li>重启MySQL服务，并登录MySQL客户端，执行以下命令：<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">user</span><span style="color:#A6ACCD;"> &#39;</span><span style="color:#82AAFF;">repl</span><span style="color:#A6ACCD;">&#39;@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> identified </span><span style="color:#F78C6C;">by</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">grant</span><span style="color:#A6ACCD;"> replication slave </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">flush privileges;</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></li><li>记下File和Position的值，例如mysql-bin.000001和154。</li><li>在从服务器上，编辑my.cnf文件，添加以下内容：<div class="language-conf"><button title="Copy Code" class="copy"></button><span class="lang">conf</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">[mysqld]</span></span>
<span class="line"><span style="color:#A6ACCD;">server-id=2</span></span>
<span class="line"><span style="color:#A6ACCD;">log-bin=mysql-bin</span></span>
<span class="line"><span style="color:#A6ACCD;">relay-log=relay-log</span></span>
<span class="line"><span style="color:#A6ACCD;">read-only=1</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li>重启MySQL服务，并登录MySQL客户端，执行以下命令：<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">change </span><span style="color:#F78C6C;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> master_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">192.168.93.100</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_password</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_log_file</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql-bin.000001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_log_pos</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">154</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">start</span><span style="color:#A6ACCD;"> slave;</span></span>
<span class="line"><span style="color:#A6ACCD;">show slave </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;">\G;</span></span>
<span class="line"></span></code></pre></div></li><li>检查Slave_IO_Running和Slave_SQL_Running的值是否都是Yes，如果是，则表示复制成功。</li></ol></li></ul><h2 id="双主集群配置" tabindex="-1">双主集群配置 <a class="header-anchor" href="#双主集群配置" aria-hidden="true">#</a></h2><p>MySQL双主复制集群是一种高可用的数据库架构，可以实现数据的双向同步和负载均衡。</p><ul><li><p>配置一个双主复制集群的大致步骤如下：</p><ol><li>在两台服务器上分别开启二进制日志，并设置不同的服务器ID和自增长步长。</li><li>在两台服务器上分别创建一个专用的复制用户，并授予相应的权限。</li><li>在两台服务器上分别配置对方的地址、端口、用户名和密码，并启动复制进程。</li><li>在两台服务器上分别检查复制状态，确保没有错误或延迟。</li></ol></li><li><p>示例 假设有两台服务器：192.168.93.100 mysql-master1 和 192.168.93.101 mysql-master2 :</p><ol><li>在mysql-master1上，编辑my.cnf文件，添加以下内容：<div class="language-conf"><button title="Copy Code" class="copy"></button><span class="lang">conf</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">[mysqld]</span></span>
<span class="line"><span style="color:#A6ACCD;">server-id=1</span></span>
<span class="line"><span style="color:#A6ACCD;">log-bin=mysql-bin</span></span>
<span class="line"><span style="color:#A6ACCD;">auto-increment-increment=2</span></span>
<span class="line"><span style="color:#A6ACCD;">auto-increment-offset=1</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li>重启MySQL服务，并登录MySQL客户端，执行以下命令：<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">user</span><span style="color:#A6ACCD;"> &#39;</span><span style="color:#82AAFF;">repl</span><span style="color:#A6ACCD;">&#39;@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> identified </span><span style="color:#F78C6C;">by</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">grant</span><span style="color:#A6ACCD;"> replication slave </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">flush privileges;</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"></span></code></pre></div></li><li>记下File和Position的值，例如mysql-bin.000001和154。</li><li>在mysql-master2上，编辑my.cnf文件，添加以下内容：<div class="language-conf"><button title="Copy Code" class="copy"></button><span class="lang">conf</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">[mysqld]</span></span>
<span class="line"><span style="color:#A6ACCD;">server-id=2</span></span>
<span class="line"><span style="color:#A6ACCD;">log-bin=mysql-bin</span></span>
<span class="line"><span style="color:#A6ACCD;">auto-increment-increment=2</span></span>
<span class="line"><span style="color:#A6ACCD;">auto-increment-offset=2</span></span>
<span class="line"><span style="color:#A6ACCD;"></span></span></code></pre></div></li><li>重启MySQL服务，并登录MySQL客户端，执行以下命令：<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#F78C6C;">create</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">user</span><span style="color:#A6ACCD;"> &#39;</span><span style="color:#82AAFF;">repl</span><span style="color:#A6ACCD;">&#39;@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;"> identified </span><span style="color:#F78C6C;">by</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">grant</span><span style="color:#A6ACCD;"> replication slave </span><span style="color:#F78C6C;">on</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;">.</span><span style="color:#89DDFF;">*</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">@</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">%</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">flush privileges;</span></span>
<span class="line"><span style="color:#A6ACCD;">show </span><span style="color:#F78C6C;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">change </span><span style="color:#F78C6C;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> master_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">192.168.93.100</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_password</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_log_file</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql-bin.000001</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_log_pos</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">154</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">start</span><span style="color:#A6ACCD;"> slave;</span></span>
<span class="line"><span style="color:#A6ACCD;">show slave </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;">\G;</span></span>
<span class="line"></span></code></pre></div></li><li>记下File和Position的值，例如mysql-bin.000002和234。</li><li>检查Slave_IO_Running和Slave_SQL_Running的值是否都是Yes，如果是，则表示从mysql-master1复制成功。</li><li>回到mysql-master1上，执行以下命令：<div class="language-sql"><button title="Copy Code" class="copy"></button><span class="lang">sql</span><pre class="shiki material-theme-palenight" tabindex="0"><code><span class="line"><span style="color:#A6ACCD;">change </span><span style="color:#F78C6C;">master</span><span style="color:#A6ACCD;"> </span><span style="color:#F78C6C;">to</span><span style="color:#A6ACCD;"> master_host</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">192.168.93.101</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_user</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">repl</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_password</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">123456</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_log_file</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">mysql-bin.000002</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">,master_log_pos</span><span style="color:#89DDFF;">=</span><span style="color:#F78C6C;">234</span><span style="color:#A6ACCD;">;</span></span>
<span class="line"><span style="color:#F78C6C;">start</span><span style="color:#A6ACCD;"> slave;</span></span>
<span class="line"><span style="color:#A6ACCD;">show slave </span><span style="color:#F78C6C;">status</span><span style="color:#A6ACCD;">\G;</span></span>
<span class="line"></span></code></pre></div></li><li>检查Slave_IO_Running和Slave_SQL_Running的值是否都是Yes，如果是，则表示从mysql-master2复制成功。</li></ol></li><li><p>优缺点</p><ul><li>双主模式的优点有： <ul><li>可以实现读写分离和负载均衡，提高服务器的利用率和性能。</li><li>可以实现主库的高可用，当一个主库发生故障时，可以快速切换到另一个主库，减少业务中断的时间。</li><li>可以实现数据的双向同步和恢复，当一个主库恢复后，可以通过复制机制与另一个主库保持一致。</li></ul></li><li>双主模式的缺点有： <ul><li>可能会出现数据冲突或死锁的问题，例如两个主库同时插入相同的主键值或修改相同的记录。</li><li>可能会出现数据延迟或丢失的问题，例如网络故障导致复制中断或延迟，或者复制过程中出现错误导致数据不一致。</li><li>需要注意避免循环复制或无限循环的问题，例如两个主库互相触发触发器或存储过程。</li></ul></li></ul></li></ul><h2 id="mha-master-high-availability" tabindex="-1">MHA（Master High Availability） <a class="header-anchor" href="#mha-master-high-availability" aria-hidden="true">#</a></h2><p>MHA模式的原理：</p><ul><li>MHA由两个组件组成，一个是MHA Manager，负责监控和管理MySQL集群，另一个是MHA Node，负责在每个MySQL节点上执行复制相关的操作。</li><li>MHA Manager可以部署在任意一台机器上，但不能部署在主库上。MHA Manager可以管理多个MySQL集群，每个集群需要有一个配置文件来指定主库和从库的信息。</li><li>MHA Node需要部署在每个MySQL节点上，包括主库和从库。MHA Node需要安装Perl模块和SSH客户端，并且需要配置SSH免密登录。</li><li>MHA Manager通过SSH连接到每个MySQL节点，定期检查主库的状态和从库的复制延迟。如果发现主库故障或者复制延迟超过阈值，就会触发故障切换的流程。</li><li>故障切换的流程分为三个阶段：第一阶段是检查配置和环境，第二阶段是选择最合适的从库作为新的主库，并且停止所有从库的复制进程，第三阶段是将其他从库重新指向新的主库，并且启动复制进程。</li><li>故障切换过程中，MHA会尽量保证数据的一致性，通过比较二进制日志文件（binlog）来找出最新的数据，并且通过relay log recovery（中继日志恢复）来避免数据丢失。</li></ul><p>MHA模式配置步骤:</p><ul><li>安装MHA Manager和MHA Node组件，可以通过源码编译或者包管理器来安装。</li><li>配置MySQL主从复制，可以使用半同步复制或者异步复制，但是需要开启binlog和relay log，并且设置server-id和log-bin参数。</li><li>配置SSH免密登录，需要在MHA Manager机器上生成SSH密钥，并且将公钥拷贝到每个MySQL节点上。</li><li>编写MHA配置文件，需要指定主库和从库的地址、端口、用户名、密码等信息，以及一些故障切换的选项。</li><li>启动MHA Manager进程，使用masterha_manager命令来启动，并且指定配置文件的路径。启动后，可以使用masterha_check_ssh和masterha_check_repl命令来检查SSH连接和复制状态是否正常。</li><li>测试故障切换，可以手动停止主库的MySQL服务或者网络服务，观察MHA Manager是否能自动检测到故障，并且执行切换操作。切换后，可以使用masterha_check_status命令来查看集群的状态。</li></ul><h2 id="pxc-percona-xtradb-cluster" tabindex="-1">PXC（Percona XtraDB Cluster） <a class="header-anchor" href="#pxc-percona-xtradb-cluster" aria-hidden="true">#</a></h2><p>PXC模式的MySQL集群架构是一种高可用的数据库解决方案，它基于Percona Server和Xtrabackup与Galera库集成，实现了同步多主复制。PXC模式的优点是可以避免数据复制延迟，保证数据的一致性和可靠性。PXC模式的缺点是可能会降低写入性能，增加网络开销和资源消耗。 使用场景：</p><ul><li>需要一个高可用的MySQL数据库，可以实现多节点同时读写，并且保证数据的强一致性。</li><li>需要一个可以快速扩展和恢复的MySQL数据库，可以利用PXC集群的自动成员管理和状态转换功能。</li><li>需要一个可以无缝迁移的MySQL数据库，可以使用mysqldump或者XtraBackup工具将原有数据库导入到PXC集群中。</li></ul></div></div></main><!--[--><!--]--><footer class="VPDocFooter" data-v-c5936a1e data-v-2813752b><div class="edit-info" data-v-2813752b><div class="edit-link" data-v-2813752b><span class="VPLink edit-link-button" data-v-2813752b data-v-a8b5c975><!--[--><svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" class="edit-link-icon" data-v-2813752b><path d="M18,23H4c-1.7,0-3-1.3-3-3V6c0-1.7,1.3-3,3-3h7c0.6,0,1,0.4,1,1s-0.4,1-1,1H4C3.4,5,3,5.4,3,6v14c0,0.6,0.4,1,1,1h14c0.6,0,1-0.4,1-1v-7c0-0.6,0.4-1,1-1s1,0.4,1,1v7C21,21.7,19.7,23,18,23z"></path><path d="M8,17c-0.3,0-0.5-0.1-0.7-0.3C7,16.5,6.9,16.1,7,15.8l1-4c0-0.2,0.1-0.3,0.3-0.5l9.5-9.5c1.2-1.2,3.2-1.2,4.4,0c1.2,1.2,1.2,3.2,0,4.4l-9.5,9.5c-0.1,0.1-0.3,0.2-0.5,0.3l-4,1C8.2,17,8.1,17,8,17zM9.9,12.5l-0.5,2.1l2.1-0.5l9.3-9.3c0.4-0.4,0.4-1.1,0-1.6c-0.4-0.4-1.2-0.4-1.6,0l0,0L9.9,12.5z M18.5,2.5L18.5,2.5L18.5,2.5z"></path></svg> Edit this page on GitHub<!--]--><!----></span></div><div class="last-updated" data-v-2813752b><p class="VPLastUpdated" data-v-2813752b data-v-355aa5ef>Last updated: <time datetime="2023-03-10T03:39:01.000Z" data-v-355aa5ef></time></p></div></div><div class="prev-next" data-v-2813752b><div class="pager" data-v-2813752b><a class="pager-link prev" href="/doc/rdb/mysqlquestion" data-v-2813752b><span class="desc" data-v-2813752b>Previous page</span><span class="title" data-v-2813752b>Mysql 常见问题</span></a></div><div class="has-prev pager" data-v-2813752b><a class="pager-link next" href="/doc/rdb/querybigdata" data-v-2813752b><span class="desc" data-v-2813752b>Next page</span><span class="title" data-v-2813752b>Mysql 查询大量数据(流式查询)</span></a></div></div></footer><!--[--><!--]--></div></div></div></div></div><footer class="VPFooter has-sidebar" data-v-93a960b4 data-v-d24360a6><div class="container" data-v-d24360a6><p class="message" data-v-d24360a6>Released under the MIT License.</p><p class="copyright" data-v-d24360a6>Copyright © 2015-present Lumiseven</p></div></footer><!--[--><!--]--></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"doc_ai_chatgpt_embdding.md\":\"54d8adc8\",\"doc_ai_project.md\":\"3c8d0da6\",\"doc_ai_random_forest_model.md\":\"01cd2067\",\"doc_es_geo.md\":\"d5589393\",\"doc_es_index.md\":\"4c2b68e6\",\"about_about_me.md\":\"4d41af70\",\"about_index.md\":\"1106d86c\",\"doc_git_command.md\":\"85598dff\",\"doc_index.md\":\"0dce9bc2\",\"doc_jvm_kotlin_corouties.md\":\"cbaf6271\",\"doc_jvm_lock4j.md\":\"852f94e7\",\"doc_nginx_caddy.md\":\"bd355f08\",\"doc_nginx_haproxyandnginx.md\":\"7b07009f\",\"doc_nginx_nginx.md\":\"7c965de1\",\"doc_others_http1_1_vs_http2.md\":\"44855778\",\"doc_jvm_concurrency.md\":\"ba1f981c\",\"doc_jvm_coroutines.md\":\"f91d7a31\",\"doc_jvm_javabase.md\":\"4b33e837\",\"doc_python_multiprocessing.md\":\"1a96d768\",\"doc_rdb_mysqlfulltextsearch.md\":\"d6923d0c\",\"doc_rdb_mysqloperation.md\":\"4dff3f24\",\"doc_rdb_mysqlquestion.md\":\"c783eb9f\",\"doc_rdb_mysqlspatialindex.md\":\"3941c197\",\"doc_rdb_mysqlvspostgres.md\":\"b1390b1e\",\"doc_rdb_querybigdata.md\":\"503d158c\",\"index.md\":\"063f227c\",\"jotting_1677990878.md\":\"f955a3f9\",\"jotting_1678330412.md\":\"5243b256\",\"jotting_1678891164.md\":\"730f7662\",\"jotting_1678937136.md\":\"9ead74bf\",\"jotting_index.md\":\"89a454fa\",\"jotting_numpy_csv_executable.md\":\"a05b39c1\",\"jotting_springboot_make_blog_api.md\":\"13c08e35\",\"doc_jvm_concurrency2.md\":\"bf68444d\",\"doc_jvm_hippo4j.md\":\"f7ade7d5\",\"doc_nginx_nginxvscaddy.md\":\"14f21533\",\"doc_es_infrequentoperation.md\":\"c7a0030b\",\"jotting_1680498848.md\":\"e891b7c6\"}")</script>
    <script type="module" async src="/assets/app.8443043e.js"></script>
    
  </body>
</html>